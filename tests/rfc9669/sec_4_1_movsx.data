# Copyright (c) Microsoft Corporation
# SPDX-License-Identifier: MIT
-- asm
# RFC 9669 Section 4.1: MOVSX semantics for ALU (8/16) and ALU64 (8/16/32), register source only.

# MOVSX (ALU, offset=8): sign-extend s8 into 32-bit, then zero upper 32.
mov32 %r1, 0x00000080
movsx832 %r2, %r1
jne32 %r2, -128, fail

# MOVSX (ALU, offset=16): sign-extend s16 into 32-bit, then zero upper 32.
mov32 %r3, 0x00008001
movsx1632 %r4, %r3
jne32 %r4, -32767, fail

# MOVSX (ALU64, offset=8): sign-extend s8 into 64-bit
mov32 %r5, 0x00000080
movsx864 %r6, %r5
jne %r6, -128, fail

# MOVSX (ALU64, offset=16): sign-extend s16 into 64-bit
mov32 %r7, 0x00008001
movsx1664 %r8, %r7
jne %r8, -32767, fail

# MOVSX (ALU64, offset=32): sign-extend s32 into 64-bit
mov32 %r9, 0x80000001
movsx3264 %r0, %r9
jne %r0, -2147483647, fail

mov %r0, 1
exit
fail:
mov %r0, 0
exit
-- result
0x1
