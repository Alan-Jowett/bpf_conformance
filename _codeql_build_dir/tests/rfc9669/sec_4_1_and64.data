# Copyright (c) Microsoft Corporation
# SPDX-License-Identifier: MIT
-- asm
# RFC 9669 Section 4.1: AND (ALU64) imm/reg semantics.

# imm variant
lddw %r1, 0xff00ff00ff00ff00
lddw %r2, 0x0f0f0f0f0f0f0f0f
and %r1, 0x0f0f0f0f

# ALU64 imm is a 32-bit value sign-extended to 64 bits.
# 0x0f0f0f0f sign-extends to 0x000000000f0f0f0f, so the upper 32 bits become 0.
lddw %r3, 0x000000000f000f00
jne %r1, %r3, fail

# reg variant
lddw %r4, 0x5555555555555555
lddw %r5, 0x0f0f0f0f0f0f0f0f
and %r4, %r5
lddw %r6, 0x0505050505050505
jne %r4, %r6, fail

mov %r0, 1
exit
fail:
mov %r0, 0
exit
-- result
0x1
